\documentclass[12pt,letterpaper]{article}
\usepackage[T1]{fontenc}
\usepackage{graphicx} % Required for inserting images
\usepackage{listings}
\usepackage{xcolor}
\usepackage{amsfonts}
\usepackage{mathptmx}
\usepackage{amsmath}
\usepackage[numbers]{natbib}
\usepackage{tikz}
\usepackage[table]{xcolor}
\usepackage{soul}
\usepackage{array}
\usepackage{stmaryrd}
\usepackage{hyperref} % Placed here in the preamble
\RequirePackage[left=3cm,right=3cm,top=3cm,bottom=3cm]{geometry} 
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Compte_rendu_du_projet_recherche_INF808-AM},
    pdfpagemode=FullScreen,
}


\definecolor{lightgray}{rgb}{0.8, 0.8, 0.8} % Define a custom light gray color
\definecolor{green}{rgb}{0.0, 0.5, 0.0} % Green for low risk
\definecolor{yellow}{rgb}{1.0, 1.0, 0.0} % Yellow for medium risk
\definecolor{red}{rgb}{1.0, 0.0, 0.0} % Red for high risk
\definecolor{blue}{rgb}{0.0, 0.0, 1.0} % Blue for very low risk


\title{Compte rendu - Projet Recherche - Emulation d'APT par Caldera et Analyse}
\author{Paul SCHELLER}
\date{Mars 2025}

\begin{document}
\input{code}
\input{front_page}

\newpage
\renewcommand{\contentsname}{Plan de l'étude}
\tableofcontents


\newpage
\section{Introduction}

À l'heure où les technologies prennent toujours plus de place dans les infrastructure des entreprises et dans notre quotidien, de nouvelles menaces surgissent. Ces dernières évoluent rapidement et représentent un réel danger que ce soit pour les entreprises comme pour les consommateurs. \\
Ainsi, il est important de se prémunir de ces menaces par la mise en place progressive et proactive de contrôles de sécurité. C'est pourquoi ce projet vise à reproduire des attaques ou ensembles d'attaques connues en s'appuyant sur le cadre MITRE ATT\&CK. Ensuite, elle sera réalisé par l'outil d'émulation Caldera puis, l'attaque sera analysé et détecté à l'aide d'un EDR comme Aurora et traité à l'aide de la partie défensive du logiciel d'émulation.

\bigskip

L'objectif de cette étude est de comprendre le comportement des attaquants dans un premier temps. Puis, d'évaluer la difficulté de détection d'une attaque soigneusement préparée. \\
De plus, cette étude va nous permettre de renforcer nos connaissances établis lors du cours INF808 ainsi que notre efficacité pour sécuriser les systèmes d'informations par l'exploitation du plein potentiel des différents outils qui seront présentés dans la suite de ce rapport.

\bigskip

Pour mener à bien cette analyse, nous avons concentré nos efforts sur la prise en main et la compréhension des outils Caldera et Aurora EDR. Ainsi, nous avons pu émuler plusieurs APT pour récupérer des journaux pertinents afin d'évaluer la possibilité d'identifier quel type d'attaque était mené afin d'y remédier.

\newpage
\section{Objectifs}

Le projet a pour objectif principal de comprendre et d'améliorer l'efficacité des équipes de défenses en cybersécurité. Pour ce faire, notre recherche va s'orienter autour de trois grands axes de la cybersécurité :  
\begin{enumerate}
    \item l'émulation d'attaques,
    \item la réaction aux attaques,
    \item l'analyse des journaux.
\end{enumerate}
Par conséquent, pour réaliser à bien ce projet, on peut définir les sous-objectifs suivants :
\begin{itemize}
    \item Comprendre le comportement des attaquants et leurs méthodes
    \item Déployer un environnement d'émulation fonctionnel
    \item Exploiter le cadre MITRE ATT\&CK pour récupérer et comprendre des attaques connues
    \item Comprendre et maitrîser l'émulation d'attaque
    \item Être capable de trier et d'analyser des journaux, à l'aide d'outils comme des EDR afin de détecter des attaques potentielles
    \item Pouvoir mettre en oeuvre une réaction aux attaques émulées
    \item Analyser les résultats obtenus
    \item Conclure sur l'efficacité de la méthode
    \item Établir des recommandations sur des possibilité d'amélioration de la méthode
\end{itemize}

Ce projet nous permet donc de mettre en place un cadre de travail pour réaliser divers attaques trouvées à l'aide de l'outil MITRE ATT\&CK, puis de réagir à ses dernières ainsi que les analyser.
Cela nous permettra de mieux comprendre le déroulement de ces actions et de saisir les difficultés qui en ressortent.

\newpage
\section{État de l'art}
\section{Les Outils}

\subsection{MITRE ATT\&CK}

\subsubsection{Description}

La corporation MITRE a conçu un cadre de connaissance permettant de rassembler les différentes techniques, tactiques et procédures (TTP) utilisées par les cybercriminels. Ce cadre s'appelle MITRE ATT\&CK (Adversarial Tactics, Technics and Common Knowledge). Cette base de connaissance ouverte recense le comportement des attaquants au cours des différentes phases d'une attaque. 

\subsubsection{Structure}

L'outil est segmenté en plusieurs matrices selon les différents environnement et surfaces d'attaques:
\begin{itemize}
    \item Entreprise (Windows, Linux, MacOS, Cloud, ...)
    \item Mobile (Android, IOS)
    \item ICS (Système de contrôle industriel)
\end{itemize}

\subsubsection{Objectifs}

L'outil a pour objectif de :
\begin{itemize}
    \item \textbf{Cartographier les attaques} pour mieux les comprendre
    \item \textbf{Améliorer l'identification et la détection} des attaques
    \item \textbf{Renforcer la défense} par la proposition de diverses mitigations
    \item \textbf{Établir un cadre commun} pour les acteurs du monde de la cybersécurité
\end{itemize}

\subsubsection{Les applications}

L'outil peut être utilisé pour :
\begin{itemize}
    \item \textbf{Analyser les menaces}
    \item \textbf{Supporter pour les équipes offensives}
    \item \textbf{Servir de base de données} pour les outils de type SIEM, ...
\end{itemize}

\subsection{Caldera}

\subsubsection{Description}

L'outil Caldera a été conçu par MITRE pour aider les entreprises à améliorer la sécurité de leurs systèmes d'informations. Pour ce faire, la plateforme open-source permet d'émuler des attaques récupérés sur le framework MITRE ATT\&CK ou d'en créer directement sur l'outil. Il permet d'automatiser les tests des équipes rouges.

\subsubsection{Fonctionnalités}

Les fonctionnalités du logiciel sont les suivantes :
\begin{itemize}
    \item \textbf{Automatiser les tests} des équipes offensives
    \item \textbf{Modulaire} : permet d'adapter le logiciel aux besoins des entreprises
    \item \textbf{Interopérabilité}
    \item \textbf{Interface visuel et intuitive}
    \item \textbf{Environnement de test} : permet d'effectuer des tests dans un environnement controlé et sécuritaire
\end{itemize}

\subsubsection{Objectifs}

Le logiciel a été conçu pour répondre aux besoins suivants :
\begin{itemize}
    \item \textbf{Tester la détection des attaques} par les dispositifs de sécurité de l'entreprise
    \item \textbf{Automatiser les tests} des équipes offensives
    \item \textbf{Former les équipes de défense} à réagir aux attaques informatiques
\end{itemize}

\subsubsection{Cas d'usage}

Les cadre d'utilisation de la plateforme sont les suivants :
\begin{itemize}
    \item \textbf{Red Teaming et Blue Teaming}
    \item \textbf{Tests des outils de détection} (SIEM, EDR, ...)
    \item \textbf{Former les équipes} 
\end{itemize}

\subsection{Aurora EDR}

Aurora EDR est une solution de détection et de réponse des terminaux (EDR) développée par Nextron Systems. Cet outil utilise les règles Sigma pour établir des profils et détecter des menaces, tout en étant totalement transparent. Aurora utilise l'intelligence artificielle et l'analyse comportementale pour détecter des activités suspectes à la différence de la majorité des EDR qui se base sur les signatures. 
Notre choix s'est porté sur Aurora pour analyser les journaux car il tourne localement sur les terminaux, réduisant donc l'impact sur les ressources système et limitant les fuites de données sensibles à l'extérieur du réseau. De plus, l'outil peut fonctionner sur des systèmes aux ressources limitées, grâce à sa légereté et son efficacité, faisant de ce dernier un très bon choix.

\subsubsection{Fonctionnalités}

Aurora possède de nombreuses fonctionnalités donc les principales consiste à :
\begin{itemize}
    \item \textbf{détecter les comportements anormaux} en temps réel,
    \item \textbf{identifier les menaces} basés sur des schémas d'attaques, en cherchant les déviances avec des comportements normaux,
    \item \textbf{répondre aux incidents} : isoler et remédier,
    \item \textbf{rechercher des signes d'intrusions avancés}
    \item \textbf{mettre en lien les résultats d'analyse} avec les données du cadre MITRE ATT\&CK.
    \item \textbf{journaliser}
\end{itemize}

\subsubsection{Avantages de l'outil}

L'outil représente un atout pour les entreprises de part sa capacité à réaliser les tâches suivantes:
\begin{enumerate}
    \item Détecter des menaces avancées
    \item Réagir rapidement aux attaques en appliquant automatiquement des mitigations
    \item Renforcer la posture de sécurité de l'entreprise
    \item et enfin faciliter les investigations
\end{enumerate}

\subsubsection{Application}

Aurora EDR est principalement utilisé pour répondre aux besoins suivants : protéger les système contre les rançongiciels, détecter des APTs, Automatiser la réponse aux incidents et aider les enquêteurs.

\bigskip

Dans notre cas, nous utiliserons principalement Aurora EDR pour aider à la détection des APTs au travers les journaux de Windows.

\subsection{Tailscale}

\subsubsection{Description}

Tailscale est un outil qui permet de réaliser un réseau virtuel privé (VPN). Il se base sur le protocole WireGuard, reconnu pour son efficacité, sa rapidité et sa sécurité. Ce qui distingue Tailscale des autres solutions VPN, c'est sa simplicité de déploiement et sa capacité à créer des réseaux maillés entre plusieurs appareils, sans nécessiter de configuration complexe. \\
Tailscale est particulièrement adapté pour les environnements de travail distribués, où les utilisateurs peuvent se connecter à des ressources internes de manière sécurisée, même lorsqu'ils sont éloignés physiquement du réseau d'entreprise.

\bigskip

De fait, l'outil va permet de créer une infrastructure pour le projet avec le déploiement de CALDERA et d'une machine virutelle cible sur Windows. Chaque machine peut communiquer directement avec l'autre et cela va nous permettre de travailler sur le projet de manière efficace sans nécessité de se connecter à un réseau local configuré.

\subsubsection{Fonctionnalités}

Les principales fonctionnalités de Tailscale incluent :
\begin{itemize}
    \item \textbf{Configuration simplifiée} : Configuration automatisée de l'infrastructure réseau (routage, contrôle des accès, DNS, ...),
    \item \textbf{Sécurité renforcée} : Chiffrement avec Wireguard,
    \item \textbf{Accès à distance} : Permet de se connecter au réseau même à distance,
    \item \textbf{Gestion des identités} : Tailscale utilise des ACL pour contrôler l'accès aux ressources. Il s'intègre avec des systèmes d'authentification tiers comme Google, Microsoft, Okta, etc.
    \item \textbf{Interopérabilité} : Fonctionne sur plusieurs plateformes comme Windows, macOS, Linux, iOS et Android.
\end{itemize}

\subsubsection{Avantages}

Tailscale présente plusieurs avantages :
\begin{itemize}
    \item \textbf{Facilité de prise en main}
    \item \textbf{Performance} : Faible latence et faible consommation de ressources grâce à WireGuard.
    \item \textbf{Sécurité} : Chiffrement de bout en bout et gestion fine des autorisations.
\end{itemize}

\subsubsection{Cas d'usage}

Tailscale peut être utilisé dans divers scénarios, tels que :
\begin{itemize}
    \item \textbf{Accès sécurisé aux ressources internes} : Par exemple, accéder à des serveurs ou bases de données internes.
    \item \textbf{Collaboration entre équipes distantes} : Permet de travailler ensemble sur un même réseau, une même infrastructure mais à distance
    \item \textbf{Administration système} : Gérer des machines distantes sans exposer les ports au public.
    \item \textbf{Création de réseaux privés temporaires} : Pour des projets ou des tests spécifiques.
\end{itemize}

\section{Déroulement du Projet}

L'étude est constituée de plusieurs étapes clés : \\
Dans une premier temps, nous allons réaliser une étude préalable pour comprendre et maitriser les différents outils présentés précedemment. \\
Ensuite, nous allons émuler plusieurs APT dans l'objectif d'évaluer dans un premier temps l'efficacité de l'outil Caldera, puis, dans un second temps d'évaluer l'utilité des outils de détection comme Aurora ainsi que les difficultés qui en sont liés. \\
Enfin, nous conclurons quant à l'utilité et les forces des outils présentés 

\subsection{Étude préalable}

\subsubsection{Installation des outils}

La première étape de l'étude a consisté à installer les différents outils présentés précédemment. \\

Pour commencer, nous avons utiliser Tailscale pour créer un réseau virtuel qui nous sert d'environnement de travail. \\
Ensuite, nous avons instancié caldera dans un conteneur Docker. Nous avons rencontré ensuite certaines difficultés pour le faire fonctionner dans ce même conteneur, puis de se connecter à l'interface web depuis une autre machine du réseau virtuel. \\
Enfin, nous avons déployer une machine virtuelle Windows serveur 2019 sur laquelle nous avons installé l'EDR Aurora. On aura par la suite configuré un Active Directory (AD) sur cette même machine pour une simulation plus proche d'un environnement d'entreprise.

\subsubsection{Prise en main des outils}
\begin{enumerate}
    \item \textbf{Caldera} : 
    Pour prendre en main l'outil Caldera, il nous a fallu commencer par comprendre comment fonctionne l'émulation d'attaque. Ainsi, nous avons utilsés les "room" de \textit{TryHackMe} à ce sujet. \\

    Pour cela nous avons dans un premier temps appris le concept d'émulation d'attaque, non seulement d'un point de vue technique mais aussi d'un point vue entreprise (entente avec l'entreprise cible, méthodologie, Rapport). Dans un second temps, nous avons mis en pratique nos connaissances via l'outil \verb|Invoke-Atomic| développé par le groupe Atomic Red Team pour l'émulation d'APT, de techniques via Powershell. \\
    Enfin nous avons réaliser le cours sur l'outil Caldera qui nous a appris à manier l'outil et ses différentes facettes. 
    \item \textbf{Windows \- Event Manager} :
    Afin de mieux comprendre comment fonctionne les attaques d'un point de vue de la victime et l'EDR Aurora, nous avons décider d'apprendre et de comprendre la gestion des journaux sur Windows. Ainsi, nous avons utilisé les outils suivant : \verb|Get-WinEvent|, \verb|wevtutil.exe| ou encore \verb|XPath Queries|. Nous avons effectuer la "room" à ce sujet sur TryHackMe. Cela nous a permis de comprendre la formes des techniques au sein des journaux, ainsi que la manière de les trier et de les analyser. \\
    \item \textbf{Aurora EDR} :
    Nous avons ensuite pris en main l'outil Aurora EDR. Pour cela, nous avons utilisé la documentation de l'outil qui nous a permis de comprendre comment fonctionne l'outil et comment il s'intègre dans notre environnement. Puis, nous avons réaliser la leçon de mise en pratique de TryHackMe. \\
\end{enumerate}


\subsection{Premier scénario}
\subsection{Second scénario}
\subsection{Troisième scénario}
\section{Observation}
\section{Conclusion}



\newpage
\bibliographystyle{unsrtnat} % or any other style like apalike, alpha, etc.

\end{document}

